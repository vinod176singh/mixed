transcations					
user_id	transcation_id	date	amount	palce	description

100gb

from pyspark.sql import SparkSession
spark=SparkSession.builder.appName('processing').getOrCreate()
transcations=spark.read.option('header','True').option('inferSchema',True).csv(transcation_path)
num_partition=transcations.getNumPartition()


select userid,date_trunc('month')
'2021-05-01'
df.createOrRepalceTempView('transaction')
from pyspark.sql.functions import col,date_trunc
transction_new=transction.withColumn('month_modified',transction.date_trunc(transction.date))
transaction_totals=transction.groupBy(transction_new.userid,transction_new.month_modified).sum('amount').alias('total_amt')
transaction_totals.select('userid',col('month_modified').alias('Months'),'total_amt')
